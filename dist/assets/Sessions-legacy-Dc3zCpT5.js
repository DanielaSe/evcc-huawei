System.register(["./index-legacy-C3BDSfGU.js","./checkmark-legacy-BuOTd23Y.js","./TopHeader-legacy-IVHoAQla.js","./TopNavigation-legacy-DyfmuRER.js"],(function(e,t){"use strict";var s,a,o,i,n,r,l,c,d,h,u,p,g,m,y,f,b,v,C,x,w,k,D,T,P,E,S,M,O,$,L,N,A,W,R,I,F,Y,B,G,K,V,j,H,_,U,q,z,Z,J,Q,X,ee,te,se;return{setters:[e=>{s=e._,a=e.f,o=e.N,i=e.O,n=e.I,r=e.R,l=e.M,c=e.c,d=e.q,h=e.a,u=e.h,p=e.t,g=e.b,m=e.d,y=e.i,f=e.Q,b=e.F,v=e.e,C=e.o,x=e.y,w=e.P,k=e.r,D=e.n,T=e.k,P=e.an,E=e.ao,S=e.ap,M=e.aq,O=e.ar,$=e.as,L=e.at,N=e.au,A=e.av,W=e.aw,R=e.ax,I=e.ay,F=e.az,Y=e.aA,B=e.aB,G=e.aC,K=e.aD,V=e.aE,j=e.aF,H=e.aG,_=e.aH,U=e.aI,q=e.a2,z=e.u,Z=e.j,J=e.G,Q=e.aJ,X=e.aK,ee=e.a1},e=>{te=e.V},e=>{se=e.T},null],execute:function(){var t=document.createElement("style");t.textContent=".options .vehicle-name[data-v-4a598d85],.options .loadpoint-name[data-v-4a598d85]{text-decoration:underline}.table[data-v-b9d6ac7e]{border-collapse:separate;border-spacing:0}.table thead[data-v-b9d6ac7e],.table tfoot[data-v-b9d6ac7e]{background:var(--evcc-background)}.table tfoot th[data-v-b9d6ac7e]{border-top-width:2px}.table thead th[data-v-b9d6ac7e]{border-bottom-width:2px}.table tbody tr:last-child td[data-v-b9d6ac7e]{border-bottom-width:0}.sticky-top[data-v-b9d6ac7e],.sticky-bottom[data-v-b9d6ac7e]{z-index:1}.sticky-top[data-v-b9d6ac7e]{top:7rem}@media (min-width: 992px){.sticky-top[data-v-b9d6ac7e]{top:4.5rem}}.sticky-top th[data-v-b9d6ac7e]{padding-top:max(.5rem,env(safe-area-inset-top))}.table-outer[data-v-b9d6ac7e]{position:relative;top:calc(max(.5rem,env(safe-area-inset-top))*-1)}.month-header[data-v-b9d6ac7e]{position:relative;z-index:2}.sticky-bottom th[data-v-b9d6ac7e]{padding-bottom:max(.5rem,env(safe-area-inset-bottom));border-bottom:none}@media (max-width: 576px){.table td[data-v-b9d6ac7e],.table th[data-v-b9d6ac7e]{width:50%}.table td[data-v-b9d6ac7e]:first-child,.table th[data-v-b9d6ac7e]:first-child,.table td[data-v-b9d6ac7e]:last-child,.table th[data-v-b9d6ac7e]:last-child{width:25%}.table td.text-truncate[data-v-b9d6ac7e],.table th.text-truncate[data-v-b9d6ac7e]{max-width:1px}}.root[data-v-414c203c]{justify-content:flex-start}.legend-color[data-v-414c203c]{width:1rem;height:1rem;flex-shrink:0;border-radius:50%}.legend-label[data-v-414c203c]{flex-shrink:0;flex-grow:0}.root--grid .legend-label[data-v-414c203c]{flex-grow:1;flex-shrink:1;text-overflow:ellipsis;overflow:hidden}.root--grid .legend-item[data-v-414c203c]{flex-grow:1;flex-basis:100%}.root--grid .legend-value[data-v-414c203c]:last-child{flex-basis:3.5rem}.root--small-equal-widths[data-v-414c203c]{display:flex;justify-content:space-evenly}.root--small-equal-widths .legend-item[data-v-414c203c]{flex-basis:8rem}.root--small-equal-widths .legend-label[data-v-414c203c]{flex-grow:1;flex-shrink:1}.btn[data-v-f688862b],.btn[data-v-f688862b]:active,.btn[data-v-f688862b]:focus{color:inherit!important}.btn[data-v-1a6ebd38]{color:inherit}.header-outer[data-v-eeade8ae]{--vertical-shift: 0rem;left:0;right:0;top:max(0rem,env(safe-area-inset-top))!important;margin:0 calc(calc(1.5rem + var(--vertical-shift)) * -1);-webkit-backdrop-filter:blur(35px);backdrop-filter:blur(35px);background-color:rgba(0,0,0,0);box-shadow:0 1px 8px 0 var(--evcc-background)}@media (min-width: 576px){.header-outer[data-v-eeade8ae]{--vertical-shift: calc((100vw - 540px)/2) }}@media (min-width: 768px){.header-outer[data-v-eeade8ae]{--vertical-shift: calc((100vw - 720px)/2) }}@media (min-width: 992px){.header-outer[data-v-eeade8ae]{--vertical-shift: calc((100vw - 960px)/2) }}@media (min-width: 1200px){.header-outer[data-v-eeade8ae]{--vertical-shift: calc((100vw - 1140px)/2) }}@media (min-width: 1400px){.header-outer[data-v-eeade8ae]{--vertical-shift: calc((100vw - 1320px)/2) }}\n/*$vite$:1*/",document.head.appendChild(t);const ae={id:"sessionDetailsModal",class:"modal fade text-dark",tabindex:"-1",role:"dialog","aria-hidden":"true"},oe={class:"modal-dialog modal-dialog-centered",role:"document"},ie={key:0,class:"modal-content"},ne={class:"modal-header"},re={class:"modal-body"},le={class:"table align-middle"},ce={class:"flex-grow-1 text-truncate loadpoint-name"},de={class:"flex-grow-1 text-truncate vehicle-name"},he={class:"align-baseline"},ue={class:"align-baseline"},pe={key:0},ge={key:0},me={class:"align-baseline"},ye={key:1},fe={class:"align-baseline"},be={key:2},ve={key:3},Ce={key:4},xe={class:"align-baseline"},we={class:"modal-footer d-flex justify-content-start"},ke={id:"deleteSessionConfirmationModal",class:"modal fade text-dark",tabindex:"-1",role:"dialog","aria-hidden":"true"},De={class:"modal-dialog modal-dialog-centered",role:"document"},Te={key:0,class:"modal-content"},Pe={class:"modal-header"},Ee={class:"modal-footer d-flex justify-content-between"},Se=s({name:"SessionDetailsModal",components:{VehicleOptions:te,CustomSelect:o},mixins:[a],props:{session:Object,currency:String,vehicles:Array,loadpoints:Array},emits:["session-changed"],computed:{chargedEnergy:function(){return 1e3*this.session.chargedEnergy},avgPower:function(){const e=this.session.chargeDuration/1e9/3600;return this.chargedEnergy/e},solarEnergy:function(){return this.chargedEnergy*(this.session.solarPercentage/100)},vehicleOptions:function(){return this.vehicles.map((e=>({name:e.title,title:e.title})))},loadpointOptions:function(){return this.loadpoints.map((e=>({value:e,name:e})))}},methods:{openSessionDetailsModal(){l.getOrCreateInstance(document.getElementById("sessionDetailsModal")).show()},openRemoveConfirmationModal(){l.getOrCreateInstance(document.getElementById("deleteSessionConfirmationModal")).show()},formatKm:function(e){return`${this.fmtNumber(r(e),0)} ${n()}`},async changeVehicle(e){await this.updateSession({vehicle:e})},async removeVehicle(){await this.updateSession({vehicle:null})},async changeLoadpoint(e){await this.updateSession({loadpoint:e})},async updateSession(e){try{await i.put("session/"+this.session.id,e),this.$emit("session-changed")}catch(t){console.error(t)}},async removeSession(){try{await i.delete("session/"+this.session.id),this.$emit("session-changed")}catch(e){console.error(e)}}}},[["render",function(e,t,s,a,o,i){const n=v("CustomSelect"),r=v("VehicleOptions");return C(),c(b,null,[(C(),d(f,{to:"body"},[h("div",ae,[h("div",oe,[s.session?(C(),c("div",ie,[h("div",ne,[h("h5",null,p(e.$t("session.title")),1),t[4]||(t[4]=h("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1))]),h("div",re,[h("table",le,[h("tbody",null,[h("tr",null,[h("th",null,p(e.$t("sessions.loadpoint")),1),h("td",null,[g(n,{id:"session.vehicle",class:"options",options:i.loadpointOptions,selected:s.session.loadpoint,onChange:t[0]||(t[0]=e=>i.changeLoadpoint(e.target.value))},{default:m((()=>[h("span",ce,p(s.session.loadpoint?s.session.loadpoint:e.$t("main.loadpoint.fallbackName")),1)])),_:1},8,["options","selected"])])]),h("tr",null,[h("th",null,p(e.$t("sessions.vehicle")),1),h("td",null,[g(r,{id:s.session.vehicle,class:"options",vehicles:i.vehicleOptions,connected:"",selected:s.session.vehicle,onChangeVehicle:i.changeVehicle,onRemoveVehicle:i.removeVehicle},{default:m((()=>[h("span",de,p(s.session.vehicle?s.session.vehicle:e.$t("main.vehicle.unknown")),1)])),_:1},8,["id","vehicles","selected","onChangeVehicle","onRemoveVehicle"])])]),h("tr",null,[h("th",he,p(e.$t("session.date")),1),h("td",null,[y(p(e.fmtFullDateTime(new Date(s.session.created),!1))+" ",1),t[5]||(t[5]=h("br",null,null,-1)),y(" "+p(e.fmtFullDateTime(new Date(s.session.finished),!1)),1)])]),h("tr",null,[h("th",ue,p(e.$t("sessions.energy")),1),h("td",null,[y(p(e.fmtWh(i.chargedEnergy,i.chargedEnergy>=1e3?e.POWER_UNIT.KW:e.POWER_UNIT.AUTO))+" ",1),s.session.chargeDuration?(C(),c("div",pe,p(e.fmtDurationNs(s.session.chargeDuration))+" (~"+p(e.fmtW(i.avgPower))+") ",1)):u("",!0)])]),null!=s.session.solarPercentage?(C(),c("tr",ge,[h("th",me,p(e.$t("sessions.solar")),1),h("td",null,p(e.fmtPercentage(s.session.solarPercentage,1))+" ("+p(e.fmtWh(i.solarEnergy,e.POWER_UNIT.AUTO))+") ",1)])):u("",!0),null!=s.session.price?(C(),c("tr",ye,[h("th",fe,p(e.$t("session.price")),1),h("td",null,[y(p(e.fmtMoney(s.session.price,s.currency))+" "+p(e.fmtCurrencySymbol(s.currency)),1),t[6]||(t[6]=h("br",null,null,-1)),y(" "+p(e.fmtPricePerKWh(s.session.pricePerKWh,s.currency)),1)])])):u("",!0),null!=s.session.co2PerKWh?(C(),c("tr",be,[h("th",null,p(e.$t("session.co2")),1),h("td",null,p(e.fmtCo2Medium(s.session.co2PerKWh)),1)])):u("",!0),s.session.odometer?(C(),c("tr",ve,[h("th",null,p(e.$t("session.odometer")),1),h("td",null,p(i.formatKm(s.session.odometer)),1)])):u("",!0),s.session.meterStart?(C(),c("tr",Ce,[h("th",xe,p(e.$t("session.meter")),1),h("td",null,[y(p(e.fmtWh(1e3*s.session.meterStart)),1),t[7]||(t[7]=h("br",null,null,-1)),y(" "+p(e.fmtWh(1e3*s.session.meterStop)),1)])])):u("",!0)])])]),h("div",we,[h("button",{type:"button",class:"btn btn-link text-danger","data-bs-dismiss":"modal",onClick:t[1]||(t[1]=(...e)=>i.openRemoveConfirmationModal&&i.openRemoveConfirmationModal(...e))},p(e.$t("session.delete")),1)])])):u("",!0)])])])),(C(),d(f,{to:"body"},[h("div",ke,[h("div",De,[s.session?(C(),c("div",Te,[h("div",Pe,[h("h5",null,p(e.$t("sessions.reallyDelete")),1)]),h("div",Ee,[h("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal",onClick:t[2]||(t[2]=(...e)=>i.openSessionDetailsModal&&i.openSessionDetailsModal(...e))},p(e.$t("session.cancel")),1),h("button",{type:"button",class:"btn btn-danger","data-bs-dismiss":"modal",onClick:t[3]||(t[3]=(...e)=>i.removeSession&&i.removeSession(...e))},p(e.$t("session.delete")),1)])])):u("",!0)])])]))],64)}],["__scopeId","data-v-4a598d85"]]),Me={xs:1,sm:2,md:3,lg:4,xl:5,xxl:6},Oe={name:"SessionTable",components:{CustomSelect:o},mixins:[a,{data:()=>({breakpoint:"md"}),methods:{updateBreakpoint(){const e=window.innerWidth;this.breakpoint=e<=575?"xs":e<=767?"sm":e<=991?"md":e<=1199?"lg":e<=1399?"xl":"xxl"}},mounted(){this.updateBreakpoint(),window.addEventListener("resize",this.updateBreakpoint)},beforeDestroy(){window.removeEventListener("resize",this.updateBreakpoint)}}],props:{sessions:{type:Array,default:()=>[]},loadpointFilter:{type:String,default:""},vehicleFilter:{type:String,default:""},currency:{type:String}},emits:["show-session"],data:()=>({selectedColumns:x.sessionColumns}),computed:{filteredSessions(){return this.sessions.filter(this.filterByLoadpoint).filter(this.filterByVehicle).sort(((e,t)=>new Date(t.created)-new Date(e.created)))},maxColumns(){return Me[this.breakpoint]||1},columns(){return[{name:"energy",unit:"kWh",total:this.chargedEnergy,value:e=>e.chargedEnergy,format:e=>this.fmtWh(1e3*e,w.KW,!1)},{name:"solar",unit:"%",total:this.solarPercentage,value:e=>e.solarPercentage,format:e=>this.fmtNumber(e,1)},{name:"price",unit:this.fmtCurrencySymbol(this.currency),total:this.price,value:e=>e.price,format:e=>this.fmtMoney(e,this.currency)},{name:"avgPrice",unit:this.pricePerKWhUnit(this.currency),total:this.pricePerKWh,value:e=>e.pricePerKWh,format:e=>this.fmtPricePerKWh(e,this.currency,!1,!1)},{name:"co2",unit:"g/kWh",total:this.co2PerKWh,value:e=>e.co2PerKWh,format:e=>this.fmtNumber(e,0)},{name:"chargeDuration",unit:"h:mm",total:this.chargeDuration,value:e=>e.chargeDuration,format:e=>this.fmtDurationNs(e,!1,"h")},{name:"avgPower",unit:"kW",total:this.avgPower,value:e=>e.chargedEnergy&&e.chargeDuration?e.chargedEnergy/this.nsToHours(e.chargeDuration):null,format:e=>e?this.fmtW(1e3*e,w.KW,!1,1):void 0}].filter((e=>"energy"===e.name||this.sessions.some((t=>e.value(t)))))},tooMuchColumns(){return this.columns.length>this.maxColumns},sortedColumns(){const e=[...this.columns],t=[];for(const s of this.selectedColumns)if(!s&&e.length)t.push(e.shift());else if(e.some((e=>e.name===s))){const a=e.find((e=>e.name===s));t.push(a);const o=e.indexOf(a);e.splice(o,1)}return t.concat(e)},columnsPerBreakpoint(){return this.sortedColumns.slice(0,this.maxColumns)},columnOptions(){return this.columns.map((e=>({name:this.$t(`sessions.${e.name}`),value:e.name,disabled:this.columnsPerBreakpoint.find((t=>t.name===e.name))})))},vehicleFilterOptions(){const e=[{name:this.$t("sessions.filter.allVehicles"),value:"",count:this.filterCountForVehicle()}];return this.vehicles.forEach((t=>{const s=this.filterCountForVehicle(t);e.push({name:t,value:t,count:s})})),e},loadpointFilterOptions(){const e=[{name:this.$t("sessions.filter.allLoadpoints"),value:"",count:this.filterCountForLoadpoint()}];return this.loadpoints.forEach((t=>{const s=this.filterCountForLoadpoint(t);e.push({name:t,value:t,count:s})})),e},chargedEnergy(){return this.filteredSessions.reduce(((e,t)=>e+t.chargedEnergy),0)},chargeDuration(){return this.filteredSessions.reduce(((e,t)=>e+t.chargeDuration),0)},price(){return this.filteredSessions.reduce(((e,t)=>e+t.price),0)},avgPower(){const{energy:e,hours:t}=this.filteredSessions.filter((e=>e.chargedEnergy&&e.chargeDuration)).reduce(((e,t)=>(e.energy+=t.chargedEnergy,e.hours+=this.nsToHours(t.chargeDuration),e)),{energy:0,hours:0});return e&&t?e/t:null},pricePerKWh(){const e=this.filteredSessions.filter((e=>null!==e.price)).reduce(((e,t)=>({price:e.price+t.price,chargedEnergy:e.chargedEnergy+t.chargedEnergy})),{price:0,chargedEnergy:0});return e.price/e.chargedEnergy},co2PerKWh(){const e=this.filteredSessions.filter((e=>null!==e.co2PerKWh)).reduce(((e,t)=>({emittedCo2:e.emittedCo2+t.chargedEnergy*t.co2PerKWh,chargedEnergy:e.chargedEnergy+t.chargedEnergy})),{emittedCo2:0,chargedEnergy:0});return e.chargedEnergy&&e.emittedCo2?e.emittedCo2/e.chargedEnergy:null},solarPercentage(){const e=this.filteredSessions.filter((e=>null!==e.solarPercentage)).reduce(((e,t)=>({chargedSolarEnergy:e.chargedSolarEnergy+t.chargedEnergy*(t.solarPercentage/100),chargedEnergy:e.chargedEnergy+t.chargedEnergy})),{chargedSolarEnergy:0,chargedEnergy:0});return 100/e.chargedEnergy*e.chargedSolarEnergy},loadpoints(){return[...new Set(this.sessions.map((e=>e.loadpoint)))]},vehicles(){return[...new Set(this.sessions.map((e=>e.vehicle)))]}},methods:{nsToHours:e=>e/1e9/3600,filterByLoadpoint(e){return!this.loadpointFilter||e.loadpoint===this.loadpointFilter},filterByVehicle(e){return!this.vehicleFilter||e.vehicle===this.vehicleFilter},filterCountForVehicle(e){return this.sessions.filter(this.filterByLoadpoint).filter((t=>!e||t.vehicle===e)).length},filterCountForLoadpoint(e){return this.sessions.filter(this.filterByVehicle).filter((t=>!e||t.loadpoint===e)).length},selectColumnPosition(e,t){this.selectedColumns[e]=t,x.sessionColumns=[...this.selectedColumns]},changeLoadpointFilter(e){const t=e.target.value||void 0;this.$router.push({query:{...this.$route.query,loadpoint:t}})},changeVehicleFilter(e){const t=e.target.value||void 0;this.$router.push({query:{...this.$route.query,vehicle:t}})},showDetails(e){this.$emit("show-session",e)}}},$e={class:"fw-normal mb-4"},Le={key:0,"data-testid":"sessions-nodata",class:"mb-5"},Ne={key:1,class:"mb-5 table-outer"},Ae={class:"table text-nowrap"},We={class:"sticky-top"},Re={"data-testid":"sessions-head"},Ie={scope:"col",class:"align-top ps-0"},Fe={scope:"col",class:"align-top d-none d-md-table-cell","data-testid":"loadpoint"},Ye={class:"fw-normal text-decoration-underline text-nowrap text-gray pe-none"},Be={scope:"col",class:"align-top d-none d-md-table-cell","data-testid":"vehicle"},Ge={class:"fw-normal text-decoration-underline text-nowrap text-gray pe-none"},Ke={scope:"col",class:"align-top d-md-none text-truncate"},Ve={class:"d-flex flex-wrap text-truncate"},je={class:"me-2 text-truncate"},He={class:"fw-normal text-decoration-underline text-nowrap text-gray pe-none text-truncate"},_e={class:"text-truncate d-flex flex-wrap"},Ue={class:"me-2 text-truncate"},qe={class:"fw-normal text-decoration-underline text-nowrap text-gray pe-none text-truncate"},ze=["data-testid"],Ze={class:"text-decoration-underline"},Je={key:1},Qe={class:"text-gray fw-normal"},Xe={class:"sticky-bottom"},et={"data-testid":"sessions-foot"},tt={scope:"col",class:"align-top ps-0"},st=["data-testid"],at=["onClick"],ot={class:"ps-0"},it={class:"d-none d-md-table-cell"},nt={class:"d-none d-md-table-cell"},rt={class:"d-md-none text-truncate"},lt={key:0,class:"text-gray"},ct={key:1},dt=s(Oe,[["render",function(e,t,s,a,o,i){const n=v("CustomSelect");return C(),c(b,null,[h("h3",$e,p(e.$t("sessions.overview")),1),0===s.sessions.length?(C(),c("div",Le,[h("p",null,p(e.$t("sessions.noData")),1)])):(C(),c("div",Ne,[h("table",Ae,[h("thead",We,[h("tr",Re,[h("th",Ie,p(e.$t("sessions.date")),1),h("th",Fe,[y(p(e.$t("sessions.loadpoint"))+" ",1),g(n,{selected:s.loadpointFilter,options:i.loadpointFilterOptions,"data-testid":"filter-loadpoint",onChange:i.changeLoadpointFilter},{default:m((()=>[h("span",Ye,p(s.loadpointFilter||e.$t("sessions.filter.filter")),1)])),_:1},8,["selected","options","onChange"])]),h("th",Be,[y(p(e.$t("sessions.vehicle"))+" ",1),g(n,{selected:s.vehicleFilter,options:i.vehicleFilterOptions,"data-testid":"filter-vehicle",onChange:i.changeVehicleFilter},{default:m((()=>[h("span",Ge,p(s.vehicleFilter||e.$t("sessions.filter.filter")),1)])),_:1},8,["selected","options","onChange"])]),h("th",Ke,[h("div",Ve,[h("div",je,p(e.$t("sessions.loadpoint")),1),g(n,{selected:s.loadpointFilter,options:i.loadpointFilterOptions,"data-testid":"filter-loadpoint",onChange:i.changeLoadpointFilter},{default:m((()=>[h("span",He,p(s.loadpointFilter||e.$t("sessions.filter.filter")),1)])),_:1},8,["selected","options","onChange"])]),h("div",_e,[h("div",Ue,p(e.$t("sessions.vehicle")),1),g(n,{selected:s.vehicleFilter,options:i.vehicleFilterOptions,"data-testid":"filter-vehicle",onChange:i.changeVehicleFilter},{default:m((()=>[h("span",qe,p(s.vehicleFilter||e.$t("sessions.filter.filter")),1)])),_:1},8,["selected","options","onChange"])])]),(C(!0),c(b,null,k(i.columnsPerBreakpoint,((t,s)=>(C(),c("th",{key:t.name,scope:"col","data-testid":`sessions-head-${t.name}`,class:"align-top text-end"},[i.tooMuchColumns?(C(),d(n,{key:0,selected:t.name,options:i.columnOptions,"data-testid":"column",onChange:e=>i.selectColumnPosition(s,e.target.value)},{default:m((()=>[h("span",Ze,p(e.$t(`sessions.${t.name}`)),1)])),_:2},1032,["selected","options","onChange"])):(C(),c("span",Je,p(e.$t(`sessions.${t.name}`)),1)),h("div",Qe,p(t.unit),1)],8,ze)))),128))])]),h("tfoot",Xe,[h("tr",et,[h("th",tt,p(e.$t("sessions.total")),1),t[0]||(t[0]=h("th",{scope:"col",class:"d-none d-md-table-cell"},null,-1)),t[1]||(t[1]=h("th",{scope:"col",class:"d-none d-md-table-cell"},null,-1)),t[2]||(t[2]=h("th",{scope:"col",class:"d-md-none"},null,-1)),(C(!0),c(b,null,k(i.columnsPerBreakpoint,(e=>(C(),c("th",{key:e.name,"data-testid":`sessions-foot-${e.name}`,scope:"col",class:"align-top text-end"},p(e.format(e.total)),9,st)))),128))])]),h("tbody",null,[(C(!0),c(b,null,k(i.filteredSessions,((t,s)=>(C(),c("tr",{key:s,role:"button","data-testid":"sessions-entry",onClick:e=>i.showDetails(t.id)},[h("td",ot,p(e.fmtFullDateTime(new Date(t.created),!0)),1),h("td",it,p(t.loadpoint),1),h("td",nt,p(t.vehicle),1),h("td",rt,[h("div",null,p(t.loadpoint),1),h("div",null,p(t.vehicle),1)]),(C(!0),c(b,null,k(i.columnsPerBreakpoint,(e=>(C(),c("td",{key:e.name,class:"text-end"},[null===e.value(t)?(C(),c("span",lt," - ")):(C(),c("span",ct,p(e.format(e.value(t))),1))])))),128))],8,at)))),128))])])]))],64)}],["__scopeId","data-v-b9d6ac7e"]]),ht={name:"LegendList",props:{legends:Array,grid:Boolean,smallEqualWidths:Boolean},methods:{valueList:e=>e?Array.isArray(e)?e:[e]:[]}},ut={class:"legend-label text-nowrap"},pt=s(ht,[["render",function(e,t,s,a,o,i){return C(),c("ul",{class:D(["root p-0 d-flex flex-wrap column-gap-4 row-gap-2 overflow-hidden",{"root--small-equal-widths":s.smallEqualWidths,"root--grid":s.grid}])},[(C(!0),c(b,null,k(s.legends,(e=>(C(),c("li",{key:e.label,class:"legend-item d-flex align-items-baseline gap-2 no-wrap overflow-hidden"},[e.color?(C(),c("div",{key:0,class:"legend-color align-self-center me-1",style:T({backgroundColor:e.color})},null,4)):u("",!0),h("div",ut,p(e.label),1),(C(!0),c(b,null,k(i.valueList(e.value),(e=>(C(),c("div",{key:e,class:"text-muted text-nowrap legend-value text-end"},p(e),1)))),128))])))),128))],2)}],["__scopeId","data-v-414c203c"]]),gt={SOLAR:"solar",PRICE:"price",CO2:"co2"},mt={NONE:"none",LOADPOINT:"loadpoint",VEHICLE:"vehicle"},yt={MONTH:"month",YEAR:"year",TOTAL:"total"};O([$,L,N,A,W,R]);const ft={name:"EnergyHistoryChart",components:{Bar:P,LegendList:pt},mixins:[a],props:{sessions:{type:Array,default:()=>[]},groupBy:{type:String,default:mt.NONE},period:{type:String,default:yt.TOTAL},colorMappings:{type:Object,default:()=>({loadpoint:{},vehicle:{}})}},computed:{firstDay(){return 0===this.sessions.length?null:new Date(this.sessions[0].created)},month(){return this.firstDay?.getMonth()+1},year(){return this.firstDay?.getFullYear()},lastDay(){return 0===this.sessions.length?null:new Date(this.sessions[this.sessions.length-1].created)},chartData(){console.log("update energy history data");const e={},t=new Set;if(this.sessions.length>0){let s,a;this.period===yt.TOTAL?(s=this.firstDay.getFullYear(),a=this.lastDay.getFullYear()):this.period===yt.YEAR?(s=1,a=12):(s=1,a=new Date(this.lastDay.getFullYear(),this.lastDay.getMonth()+1,0).getDate());for(let t=s;t<=a;t++)e[t]={};this.sessions.forEach((s=>{let a;const o=new Date(s.created);if(a=this.period===yt.MONTH?o.getDate():this.period===yt.YEAR?o.getMonth()+1:o.getFullYear(),this.groupBy===mt.NONE){t.add("grid"),t.add("self");const o=s.chargedEnergy,i=o/100*s.solarPercentage,n=o-i;e[a].self=(e[a].self||0)+i,e[a].grid=(e[a].grid||0)+n}else{const o=s[this.groupBy];t.add(o),e[a][o]=(e[a][o]||0)+s.chargedEnergy}}))}const s=Array.from(t).map((t=>{const s=this.groupBy===mt.NONE?"solar":this.groupBy;return{backgroundColor:this.colorMappings[s][t],label:this.groupBy===mt.NONE?this.$t(`sessions.group.${t}`):t,data:Object.values(e).map((e=>e[t]||0)),borderRadius:e=>{const{dataIndex:t,datasetIndex:s}=e,a=e.dataset.data[t],o=e.chart.data.datasets.slice(s+1).some((e=>(e?.data[t]||0)>.04));return a>.04&&!o?{topLeft:10,topRight:10}:{topLeft:0,topRight:0}}}}));return{labels:Object.keys(e),datasets:s}},legends(){return this.chartData.datasets.map((e=>({label:e.label,color:e.backgroundColor,value:this.fmtWh(1e3*e.data.reduce(((e,t)=>e+t),0),w.AUTO)})))},options(){const e=this;return{...M,locale:this.$i18n?.locale,color:E.text,borderSkipped:!1,maxBarThickness:40,animation:!1,plugins:{...M.plugins,tooltip:{...M.plugins.tooltip,axis:"x",positioner:e=>{const{chart:t,tooltipPosition:s}=e,{tooltip:a}=t,{width:o,height:i}=a,{x:n,y:r}=s(),{innerWidth:l,innerHeight:c}=window;return{x:Math.min(n,l-o),y:Math.min(r,c-i)}},callbacks:{title:e=>{const{label:t}=e[0];if(this.period===yt.TOTAL)return t;if(this.period===yt.YEAR){const e=new Date(this.year,t-1,1);return this.fmtMonth(e)}{const e=new Date(this.year,this.month-1,t);return this.fmtDayMonth(e)}},label:e=>{const t=e.dataset.label||"",s=e.raw||0;return s?`${t}: ${this.fmtWh(1e3*s,w.AUTO)}`:null},labelColor:S(!1),labelPointStyle:function(){return{pointStyle:"circle"}}},itemSort:function(e,t){return t.datasetIndex-e.datasetIndex}}},scales:{x:{stacked:!0,border:{display:!1},grid:{display:!1},ticks:{color:E.muted,callback:function(t){return e.period===yt.YEAR?e.fmtMonth(new Date(e.year,t,1),!0):this.getLabelForValue(t)}}},y:{stacked:!0,border:{display:!1},grid:{color:E.border},title:{text:"kWh",display:!0,color:E.muted},ticks:{callback:e=>this.fmtWh(1e3*e,w.KW,!1,0),color:E.muted,maxTicksLimit:6},position:"right",min:0}}}}}},bt={style:{position:"relative",height:"300px"},class:"my-3"},vt=s(ft,[["render",function(e,t,s,a,o,i){const n=v("Bar"),r=v("LegendList");return C(),c("div",null,[h("div",bt,[g(n,{data:i.chartData,options:i.options},null,8,["data","options"])]),g(r,{legends:i.legends},null,8,["legends"])])}]]);O([F,Y,A,W,R]);const Ct={name:"EnergyGroupedChart",components:{Doughnut:I,LegendList:pt},mixins:[a],props:{sessions:{type:Array,default:()=>[]},groupBy:{type:String,default:mt.NONE},colorMappings:{type:Object,default:()=>({loadpoint:{},vehicle:{},solar:{}})}},computed:{chartData(){console.log("update energy aggregate data");const e={};if(this.groupBy===mt.NONE){const t=this.sessions.reduce(((e,t)=>e+t.chargedEnergy),0),s=this.sessions.reduce(((e,t)=>e+t.chargedEnergy/100*t.solarPercentage),0);e.self=s,e.grid=t-s}else this.sessions.forEach((t=>{const s=t[this.groupBy];e[s]||(e[s]=0),e[s]+=t.chargedEnergy}));const t=Object.entries(e),s=t.map((([e])=>this.groupBy===mt.NONE?this.$t(`sessions.group.${e}`):e)),a=t.map((([,e])=>e)),o=this.groupBy===mt.NONE?"solar":this.groupBy;return{labels:s,datasets:[{data:a,backgroundColor:t.map((([e])=>this.colorMappings[o][e]))}]}},legends(){const e=this.chartData.datasets[0].data.reduce(((e,t)=>e+t),0),t=Math.max(...this.chartData.datasets[0].data),s=t<1?w.W:t>1e4?w.MW:w.KW,a=t=>this.fmtPercentage(100/e*t,1),o=e=>this.fmtWh(1e3*e,s);return this.chartData.labels.map(((e,t)=>({label:e,color:this.chartData.datasets[0].backgroundColor[t],value:[o(this.chartData.datasets[0].data[t]),a(this.chartData.datasets[0].data[t])]})))},options(){return{...M,locale:this.$i18n?.locale,aspectRatio:1,borderRadius:10,color:E.text,borderWidth:3,borderColor:E.background,cutout:"70%",radius:"95%",animation:{duration:250},plugins:{...M.plugins,tooltip:{...M.plugins.tooltip,axis:"r",position:"center",callbacks:{label:e=>this.formatValue(e.raw||0),labelColor:S(!1)}}}}}},methods:{formatValue(e){return this.fmtWh(1e3*e,w.AUTO)}}},xt={key:0,class:"row"},wt={class:"col-12 col-md-6 mb-3"},kt={class:"col-12 col-md-6 d-flex align-items-center"},Dt=s(Ct,[["render",function(e,t,s,a,o,i){const n=v("Doughnut"),r=v("LegendList");return i.chartData.labels.length>1?(C(),c("div",xt,[h("div",wt,[g(n,{data:i.chartData,options:i.options},null,8,["data","options"])]),h("div",kt,[g(r,{legends:i.legends,grid:""},null,8,["legends"])])])):u("",!0)}]]);O([K,Y,W,R]);const Tt={name:"SolarGroupedChart",components:{PolarArea:B,LegendList:pt},mixins:[a],props:{sessions:{type:Array,default:()=>[]},groupBy:{type:String,default:mt.LOADPOINT},colorMappings:{type:Object,default:()=>({loadpoint:{},vehicle:{}})}},computed:{chartData(){console.log("update solar grouped data");const e={};this.sessions.forEach((t=>{const s=t[this.groupBy];e[s]||(e[s]={grid:0,self:0});const a=t.chargedEnergy,o=a/100*t.solarPercentage,i=a-o;e[s].self+=o,e[s].grid+=i}));const t=Object.entries(e).sort(((e,t)=>t[1].grid+t[1].self-(e[1].grid+e[1].self))),s=t.map((([e])=>e)),a=t.map((([,e])=>{const t=e.grid+e.self;return e.self/t*100})),o=this.groupBy===mt.NONE?"solar":this.groupBy,i=s.map((e=>this.colorMappings[o][e])),n=i.map((e=>G(e)));return{labels:s,datasets:[{data:a,borderColor:i,backgroundColor:n}]}},legends(){return this.chartData.labels.map(((e,t)=>({label:e,color:this.chartData.datasets[0].borderColor[t],value:this.fmtPercentage(this.chartData.datasets[0].data[t],1)})))},options(){return{...M,locale:this.$i18n?.locale,aspectRatio:1,borderRadius:8,borderWidth:3,color:E.text,spacing:0,radius:"100%",plugins:{...M.plugins,tooltip:{...M.plugins.tooltip,axis:"r",position:"topBottomCenter",callbacks:{title:()=>null,label:e=>{const{label:t,raw:s=0}=e;return t+": "+this.fmtPercentage(s,1)},labelColor:S(!0)}}},scales:{r:{min:0,max:100,ticks:{stepSize:25,color:E.muted,backdropColor:E.background},grid:{color:E.border}}}}}}},Pt={key:0,class:"row"},Et={class:"col-12 col-md-6 mb-3"},St={class:"col-12 col-md-6 d-flex align-items-center py-0 py-md-3"},Mt=s(Tt,[["render",function(e,t,s,a,o,i){const n=v("PolarArea"),r=v("LegendList");return i.chartData.labels.length>1?(C(),c("div",Pt,[h("div",Et,[g(n,{data:i.chartData,options:i.options},null,8,["data","options"])]),h("div",St,[g(r,{legends:i.legends,grid:""},null,8,["legends"])])])):u("",!0)}]]);O([K,j,H,_,R]);const Ot={name:"SolarYearChart",components:{Radar:V,LegendList:pt},mixins:[a],props:{sessions:{type:Array,default:()=>[]},period:{type:String,default:"total"}},computed:{firstDay(){return 0===this.sessions.length?null:new Date(this.sessions[0].created)},lastDay(){return 0===this.sessions.length?null:new Date(this.sessions[this.sessions.length-1].created)},chartData(){if(console.log("update solar month data"),!this.sessions.length>0)return{labels:[],datasets:[]};const e=this.firstDay.getFullYear(),t=this.lastDay.getFullYear(),s={},a=[];for(let i=t;i>=e;i--){const e=`${i}`;a.push(e),s[e]={},console.log("year",e);for(let t=1;t<=12;t++)s[e][t]={}}this.sessions.forEach((e=>{const t=new Date(e.created),a=`${t.getFullYear()}`,o=`${t.getMonth()+1}`,i=e.chargedEnergy,n=i/100*e.solarPercentage,r=i-n;s[a][o].self=(s[a][o].self||0)+n,s[a][o].grid=(s[a][o].grid||0)+r}));const o=a.map((e=>{const t=E.selfPalette[a.indexOf(e)];return{backgroundColor:1===a.length?G(t):"transparent",borderColor:t,label:e,data:Object.values(s[e]).map((({self:e=0,grid:t=0})=>{const s=e+t;return 0===s?null:e/s*100})),yearData:Object.values(s[e]).reduce(((e,{self:t=0,grid:s=0})=>({self:e.self+t,grid:e.grid+s})),{self:0,grid:0})}}));return{labels:Object.keys(s[e]).map((t=>this.fmtMonth(new Date(e,t-1,1),!0))),datasets:o}},legends(){return"total"===this.period?this.chartData.datasets.map((e=>{const t=e.label,{self:s,grid:a}=e.yearData,o=s+a,i=0===o?"- %":this.fmtPercentage(s/o*100,1);return{label:t,color:e.borderColor,value:i}})):this.chartData.labels.map(((e,t)=>({label:e,value:null===this.chartData.datasets[0].data[t]?"- %":this.fmtPercentage(this.chartData.datasets[0].data[t],1)})))},options(){return{...M,locale:this.$i18n?.locale,aspectRatio:1,borderWidth:4,color:E.text,spacing:0,radius:"100%",elements:{line:{tension:.05}},plugins:{...M.plugins,tooltip:{...M.plugins.tooltip,axis:"xy",position:"topBottomCenter",callbacks:{label:e=>{const t=e.raw||0;return(e.dataset.label||"")+": "+this.fmtPercentage(t,1)},labelColor:S(!0)}}},scales:{r:{min:0,max:100,beginAtZero:!1,ticks:{stepSize:20,color:E.muted,backdropColor:E.background,font:{size:10},callback:e=>this.fmtPercentage(e,0)},angleLines:{display:!1},grid:{color:E.border}}}}}}},$t={key:0,class:"row"},Lt={class:"col-12 col-md-6 mb-3"},Nt={class:"col-12 col-md-6 d-flex align-items-center py-0 py-md-3"},At=s(Ot,[["render",function(e,t,s,a,o,i){const n=v("Radar"),r=v("LegendList");return i.chartData.labels.length>1?(C(),c("div",$t,[h("div",Lt,[g(n,{data:i.chartData,options:i.options},null,8,["data","options"])]),h("div",Nt,[g(r,{legends:i.legends,"small-equal-widths":""},null,8,["legends"])])])):u("",!0)}]]);O([$,L,N,W,A,U,H,R]);const Wt={name:"CostHistoryChart",components:{Bar:P,LegendList:pt},mixins:[a],props:{sessions:{type:Array,default:()=>[]},groupBy:{type:String,default:mt.NONE},costType:{type:String,default:gt.PRICE},period:{type:String,default:yt.TOTAL},currency:{type:String,default:"EUR"},colorMappings:{type:Object,default:()=>({loadpoint:{},vehicle:{}})},suggestedMaxAvgCost:{type:Number,default:0},suggestedMaxCost:{type:Number,default:0}},computed:{firstDay(){return 0===this.sessions.length?null:new Date(this.sessions[0].created)},month(){return this.firstDay?.getMonth()+1},year(){return this.firstDay?.getFullYear()},lastDay(){return 0===this.sessions.length?null:new Date(this.sessions[this.sessions.length-1].created)},chartData(){console.log("update cost history data");const e={},t=new Set;if(this.sessions.length>0){let s,a;this.period===yt.TOTAL?(s=this.firstDay.getFullYear(),a=this.lastDay.getFullYear()):this.period===yt.YEAR?(s=1,a=12):(s=1,a=new Date(this.lastDay.getFullYear(),this.lastDay.getMonth()+1,0).getDate());for(let t=s;t<=a;t++)e[t]={};this.sessions.forEach((s=>{let a;const o=new Date(s.created);a=this.period===yt.MONTH?o.getDate():this.period===yt.YEAR?o.getMonth()+1:o.getFullYear();const i=this.groupBy===mt.NONE?this.costType:s[this.groupBy];t.add(i);const n=this.costType===gt.PRICE?s.price:s.co2PerKWh*s.chargedEnergy;e[a][i]=(e[a][i]||0)+n,e[a].totalCost=(e[a].totalCost||0)+n,e[a].totalKWh=(e[a].totalKWh||0)+s.chargedEnergy,e[a].avgCost=e[a].totalCost/e[a].totalKWh}))}const s=Array.from(t).map((t=>{const s=this.groupBy===mt.NONE?"cost":this.groupBy;return{type:"bar",backgroundColor:this.colorMappings[s][t],label:this.groupBy===mt.NONE?this.$t(`sessions.group.${t}`):t,data:Object.values(e).map((e=>e[t]||0)),borderRadius:e=>{const{dataIndex:t,datasetIndex:s}=e,a=e.dataset.data[t],o=e.chart.data.datasets.filter((e=>"bar"===e.type)).slice(s+1).some((e=>(e?.data[t]||0)>.04));return a>.04&&!o?{topLeft:10,topRight:10}:{topLeft:0,topRight:0}}}})),a=this.costType===gt.PRICE?E.pricePerKWh:E.co2PerKWh;return s.push({type:"line",label:this.costType===gt.PRICE?this.$t("sessions.avgPrice"):this.$t("sessions.co2"),data:Object.values(e).map((e=>e.avgCost||null)),yAxisID:"y1",tension:.25,pointRadius:0,pointHoverRadius:6,borderColor:a,backgroundColor:a,borderWidth:2,spanGaps:!0}),{labels:Object.keys(e),datasets:s}},legends(){return this.chartData.datasets.map((e=>{let t=null;if("line"===e.type){const s=e.data.filter((e=>null!==e)),a=Math.min(...s),o=Math.max(...s),i=(e,t)=>this.costType===gt.PRICE?this.fmtPricePerKWh(e,this.currency,!1,t):t?this.fmtCo2Medium(e):this.fmtGrams(e,!1);t=`${i(a,!1)} – ${i(o,!0)}`}else{const s=e.data.reduce(((e,t)=>e+t),0);t=this.costType===gt.PRICE?this.fmtMoney(s,this.currency,!0,!0):this.fmtGrams(s)}return{label:e.label,color:e.backgroundColor,value:t}}))},options(){const e=this;return{...M,locale:this.$i18n?.locale,color:E.text,borderSkipped:!1,maxBarThickness:40,animation:!1,plugins:{...M.plugins,tooltip:{...M.plugins.tooltip,axis:"x",positioner:e=>{const{chart:t,tooltipPosition:s}=e,{tooltip:a}=t,{width:o,height:i}=a,{x:n,y:r}=s(),{innerWidth:l,innerHeight:c}=window;return{x:Math.min(n,l-o),y:Math.min(r,c-i)}},callbacks:{title:e=>{const{label:t}=e[0];if(this.period===yt.TOTAL)return t;if(this.period===yt.YEAR){const e=new Date(this.year,t-1,1);return this.fmtMonth(e)}{const e=new Date(this.year,this.month-1,t);return this.fmtDayMonth(e)}},label:e=>{const t=e.dataset.label||"",s=e.raw;return"line"===e.dataset.type?null===s?null:`${t}: ${this.costType===gt.PRICE?this.fmtPricePerKWh(s,this.currency,!1):this.fmtCo2Medium(s)}`:s?`${t}: ${this.costType===gt.PRICE?this.fmtMoney(s,this.currency,!0,!0):this.fmtGrams(s)}`:null},labelColor:S(!1)},itemSort:function(e,t){return t.datasetIndex-e.datasetIndex}}},scales:{x:{stacked:!0,border:{display:!1},grid:{display:!1},ticks:{color:E.muted,callback:function(t){return e.period===yt.YEAR?e.fmtMonth(new Date(e.year,t,1),!0):this.getLabelForValue(t)}}},y:{stacked:!0,position:"right",border:{display:!1},grid:{color:E.border},title:{text:"kgCO₂e",display:this.costType===gt.CO2,color:E.muted},ticks:{callback:e=>this.costType===gt.PRICE?this.fmtMoney(e,this.currency,!1,!0):this.fmtNumber(e/1e3,0),color:E.muted,maxTicksLimit:6},suggestedMax:this.suggestedMaxCost,min:0},y1:{position:"left",border:{display:!1},suggestedMax:this.suggestedMaxAvgCost,grid:{drawOnChartArea:!1},title:{text:this.costType===gt.CO2?"gCO₂e/kWh":this.pricePerKWhUnit(this.currency,!1),display:!0,color:E.muted},ticks:{callback:e=>this.costType===gt.PRICE?this.fmtPricePerKWh(e,this.currency,!1,!1):this.fmtNumber(e,0),color:E.muted,maxTicksLimit:6}}}}}}},Rt={style:{position:"relative",height:"300px"},class:"my-3"},It=s(Wt,[["render",function(e,t,s,a,o,i){const n=v("Bar"),r=v("LegendList");return C(),c("div",null,[h("div",Rt,[g(n,{data:i.chartData,options:i.options},null,8,["data","options"])]),g(r,{legends:i.legends},null,8,["legends"])])}]]);O([F,Y,A,W,R]);const Ft={name:"CostGroupedChart",components:{Doughnut:I,LegendList:pt},mixins:[a],props:{sessions:{type:Array,default:()=>[]},groupBy:{type:String,default:mt.LOADPOINT},colorMappings:{type:Object,default:()=>({loadpoint:{},vehicle:{}})},currency:{type:String,default:"EUR"},costType:{type:String,default:gt.PRICE}},computed:{chartData(){console.log(`update ${this.costType} grouped data`);const e={};this.sessions.forEach((t=>{const s=t[this.groupBy];e[s]||(e[s]=0),this.costType===gt.PRICE?e[s]+=t.price:this.costType===gt.CO2&&(e[s]+=t.co2PerKWh*t.chargedEnergy)}));const t=Object.entries(e).sort(((e,t)=>t[1]-e[1])),s=t.map((([e])=>e)),a=t.map((([,e])=>e)),o=s.map((e=>this.colorMappings[this.groupBy][e]));return{labels:s,datasets:[{data:a,backgroundColor:o}]}},legends(){const e=this.chartData.datasets[0].data.reduce(((e,t)=>e+t),0),t=t=>this.fmtPercentage(100/e*t,1);return this.chartData.labels.map(((e,s)=>({label:e,color:this.chartData.datasets[0].backgroundColor[s],value:[this.formatValue(this.chartData.datasets[0].data[s]),t(this.chartData.datasets[0].data[s])]})))},options(){return{...M,locale:this.$i18n?.locale,aspectRatio:1,borderRadius:10,color:E.text,borderWidth:3,borderColor:E.background,cutout:"70%",radius:"95%",animation:{duration:250},plugins:{...M.plugins,tooltip:{...M.plugins.tooltip,axis:"r",position:"center",callbacks:{label:e=>this.formatValue(e.raw||0),labelColor:S(!1)}}}}}},methods:{formatValue(e){return this.costType===gt.PRICE?this.fmtMoney(e,this.currency,!0,!0):this.fmtGrams(e)}}},Yt={key:0,class:"row"},Bt={class:"col-12 col-md-6 mb-3"},Gt={class:"col-12 col-md-6 d-flex align-items-center"},Kt=s(Ft,[["render",function(e,t,s,a,o,i){const n=v("Doughnut"),r=v("LegendList");return i.chartData.labels.length>1?(C(),c("div",Yt,[h("div",Bt,[g(n,{data:i.chartData,options:i.options},null,8,["data","options"])]),h("div",Gt,[g(r,{legends:i.legends,grid:""},null,8,["legends"])])])):u("",!0)}]]);O([K,Y,W,R]);const Vt={name:"AvgCostGroupedChart",components:{PolarArea:B,LegendList:pt},mixins:[a],props:{sessions:{type:Array,default:()=>[]},currency:{type:String,default:"EUR"},groupBy:{type:String,default:mt.LOADPOINT},colorMappings:{type:Object,default:()=>({loadpoint:{},vehicle:{}})},suggestedMax:{type:Number,default:0},costType:{type:String,default:gt.PRICE}},computed:{chartData(){console.log(`update ${this.costType} grouped data`);const e={};this.sessions.forEach((t=>{const s=t[this.groupBy];e[s]||(e[s]={energy:0,cost:0});const a=t.chargedEnergy;this.costType===gt.CO2?(e[s].energy+=a,e[s].cost+=t.co2PerKWh*a):this.costType===gt.PRICE&&(e[s].energy+=a,e[s].cost+=t.price)}));const t=Object.entries(e).sort(((e,t)=>t[1].cost-e[1].cost)),s=t.map((([e])=>e)),a=t.map((([,e])=>e.cost/e.energy)),o=s.map((e=>this.colorMappings[this.groupBy][e])),i=o.map((e=>G(e)));return{labels:s,datasets:[{data:a,borderColor:o,backgroundColor:i}]}},legends(){return this.chartData.labels.map(((e,t)=>({label:e,color:this.chartData.datasets[0].borderColor[t],value:this.formatValue(this.chartData.datasets[0].data[t])})))},options(){return{...M,locale:this.$i18n?.locale,aspectRatio:1,borderRadius:8,borderWidth:3,color:E.text,spacing:0,radius:"100%",plugins:{...M.plugins,tooltip:{...M.plugins.tooltip,axis:"r",position:"topBottomCenter",callbacks:{title:()=>null,label:e=>{const{label:t,raw:s=0}=e;return t+": "+(this.costType===gt.CO2?this.fmtCo2Long(s):this.fmtPricePerKWh(s,this.currency))},labelColor:S(!0)}}},scales:{r:{suggestedMin:0,suggestedMax:this.suggestedMax,beginAtZero:!1,ticks:{color:E.muted,backdropColor:E.background,font:{size:10},callback:this.formatValue,maxTicksLimit:6},angleLines:{display:!1},grid:{color:E.border}}}}}},methods:{formatValue(e){return this.costType===gt.CO2?this.fmtCo2Medium(e):this.fmtPricePerKWh(e,this.currency)}}},jt={key:0,class:"row"},Ht={class:"col-12 col-md-6 mb-3"},_t={class:"col-12 col-md-6 d-flex align-items-center py-0 py-md-3"},Ut=s(Vt,[["render",function(e,t,s,a,o,i){const n=v("PolarArea"),r=v("LegendList");return i.chartData.labels.length>1?(C(),c("div",jt,[h("div",Ht,[g(n,{data:i.chartData,options:i.options},null,8,["data","options"])]),h("div",_t,[g(r,{legends:i.legends,grid:""},null,8,["legends"])])])):u("",!0)}]]),qt=s({name:"PeriodSelector",components:{SelectGroup:q},props:{period:{type:String,required:!0},periodOptions:{type:Array,required:!0}},emits:["update:period"],methods:{changePeriod(e){this.$emit("update:period",e)}}},[["render",function(e,t,s,a,o,i){const n=v("SelectGroup");return C(),c(b,null,[g(n,{id:"sessionsPeriodSmall",class:"w-100 d-flex d-lg-none",options:s.periodOptions,modelValue:s.period,"onUpdate:modelValue":i.changePeriod},null,8,["options","modelValue","onUpdate:modelValue"]),g(n,{id:"sessionsPeriod",class:"w-100 d-none d-lg-flex",options:s.periodOptions,large:"",modelValue:s.period,"onUpdate:modelValue":i.changePeriod},null,8,["options","modelValue","onUpdate:modelValue"])],64)}]]);class zt extends HTMLElement{connectedCallback(){this.setAttribute("data-shopicon",!0),this.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48"><path d="M0 0h48v48H0z" fill="none"/><path d="M34.586 12.586L23.171 24l11.415 11.414 2.828-2.828L28.829 24l8.585-8.586-2.828-2.828z"/><path d="M25.414 15.414l-2.828-2.828L11.171 24l11.415 11.413 2.828-2.828L16.829 24l8.585-8.586z"/></svg>'}}window.customElements.define("shopicon-regular-angledoubleleftsmall",zt);const Zt={name:"DateNavigatorButton",props:{disabled:Boolean,prev:Boolean,next:Boolean,onClick:Function},computed:{icon(){return this.prev?"shopicon-regular-angledoubleleftsmall":this.next?"shopicon-regular-angledoublerightsmall":null},iconClass(){return this.prev?"me-1":this.next?"ms-1":""}}},Jt=["disabled"],Qt={name:"DateNavigator",components:{CustomSelect:o,DateNavigatorButton:s(Zt,[["render",function(e,t,s,a,o,i){return C(),c("button",{class:"btn btn-sm border-0",disabled:s.disabled,onClick:t[0]||(t[0]=(...e)=>s.onClick&&s.onClick(...e))},[(C(),d(z(i.icon),{size:"s",class:D(i.iconClass)},null,8,["class"]))],8,Jt)}],["__scopeId","data-v-f688862b"]])},mixins:[a],props:{month:Number,year:Number,startDate:Date,showMonth:Boolean,showYear:Boolean},emits:["update-date"],computed:{hasPrevMonth(){return this.year>this.startDate.getFullYear()||this.month>this.startDate.getMonth()+1},hasNextMonth(){const e=new Date;return this.year<e.getFullYear()||this.month<e.getMonth()+1},hasPrevYear(){return this.year>this.startDate.getFullYear()},hasNextYear(){return this.year<(new Date).getFullYear()},monthOptions(){return Array.from({length:12},((e,t)=>t+1)).map((e=>({name:this.fmtMonth(new Date(this.year,e-1,1)),value:e})))},monthYearOptions(){const e=this.startDate,t=new Date,s=[];for(let a=e.getFullYear();a<=t.getFullYear();a++){const o=a===e.getFullYear()?e.getMonth()+1:1,i=a===t.getFullYear()?t.getMonth()+1:12;for(let e=o;e<=i;e++)s.push({name:this.fmtMonthYear(new Date(a,e-1,1)),value:`${a}-${e}`})}return s},yearOptions(){const e=this.startDate,t=new Date,s=[];for(let a=e.getFullYear();a<=t.getFullYear();a++)s.push({name:a,value:a});return s},monthName(){const e=new Date;return e.setMonth(this.month-1,1),this.fmtMonth(e)},monthYearName(){const e=new Date;return e.setMonth(this.month-1,1),e.setFullYear(this.year),this.fmtMonthYear(e)}},methods:{emitPrevMonth(){const e=new Date(this.year,this.month-2,1);this.$emit("update-date",{year:e.getFullYear(),month:e.getMonth()+1})},emitNextMonth(){const e=new Date(this.year,this.month,1);this.$emit("update-date",{year:e.getFullYear(),month:e.getMonth()+1})},emitPrevYear(){this.$emit("update-date",{year:this.year-1,month:void 0})},emitNextYear(){this.$emit("update-date",{year:this.year+1,month:void 0})},emitMonth(e){this.$emit("update-date",{year:this.year,month:e})},emitMonthYear(e){const[t,s]=e.split("-");this.$emit("update-date",{year:parseInt(t),month:parseInt(s)})},emitYear(e){this.$emit("update-date",{year:e,month:void 0})}}},Xt={key:0,class:"d-none d-sm-flex justify-content-between"},es={class:"btn btn-sm border-0 text-truncate h-100",style:{width:"8em"},"data-testid":"navigate-month"},ts={key:1,class:"d-flex d-sm-none justify-content-between"},ss={class:"btn btn-sm border-0 h-100 text-truncate","data-testid":"navigate-month-year"},as={class:"btn btn-sm border-0 h-100",style:{width:"4em"},"data-testid":"navigate-year"},os=s(Qt,[["render",function(e,t,s,a,o,i){const n=v("DateNavigatorButton"),r=v("CustomSelect");return C(),c("div",{class:D(["d-sm-flex justify-content-lg-end gap-lg-4",s.showMonth?"justify-content-between":"justify-content-end"])},[s.showMonth?(C(),c("div",Xt,[g(n,{prev:"",disabled:!i.hasPrevMonth,onClick:i.emitPrevMonth,"data-testid":"navigate-prev-month"},null,8,["disabled","onClick"]),g(r,{id:"sessionsMonth",options:i.monthOptions,selected:s.month,onChange:t[0]||(t[0]=e=>i.emitMonth(e.target.value))},{default:m((()=>[h("button",es,p(i.monthName),1)])),_:1},8,["options","selected"]),g(n,{next:"",disabled:!i.hasNextMonth,onClick:i.emitNextMonth,"data-testid":"navigate-next-month"},null,8,["disabled","onClick"])])):u("",!0),s.showMonth?(C(),c("div",ts,[g(n,{prev:"",disabled:!i.hasPrevMonth,onClick:i.emitPrevMonth,"data-testid":"navigate-prev-year-month"},null,8,["disabled","onClick"]),g(r,{id:"sessionsMonthYear",options:i.monthYearOptions,selected:s.month,onChange:t[1]||(t[1]=e=>i.emitMonthYear(e.target.value))},{default:m((()=>[h("button",ss,p(i.monthYearName),1)])),_:1},8,["options","selected"]),g(n,{next:"",disabled:!i.hasNextMonth,onClick:i.emitNextMonth,"data-testid":"navigate-next-year-month"},null,8,["disabled","onClick"])])):u("",!0),s.showYear?(C(),c("div",{key:2,class:D(["justify-content-between",s.showMonth?"d-none d-sm-flex":"d-flex"])},[g(n,{prev:"",disabled:!i.hasPrevYear,onClick:i.emitPrevYear,"data-testid":"navigate-prev-year"},null,8,["disabled","onClick"]),g(r,{id:"sessionsYear",options:i.yearOptions,selected:s.year,onChange:t[2]||(t[2]=e=>i.emitYear(e.target.value))},{default:m((()=>[h("button",as,p(s.year),1)])),_:1},8,["options","selected"]),g(n,{next:"",disabled:!i.hasNextYear,onClick:i.emitNextYear,"data-testid":"navigate-next-year"},null,8,["disabled","onClick"])],2)):u("",!0)],2)}],["__scopeId","data-v-1a6ebd38"]]),is=s({name:"Total",mixins:[Z]},[["render",function(e,t,s,a,o,i){return C(),c("svg",{style:T(e.svgStyle),viewBox:"0 0 24 24"},t[0]||(t[0]=[h("path",{fill:"currentColor",d:"M4.83 4.61A1 1 0 0 1 5.75 4h12.5a1 1 0 1 1 0 2H8.11l4.95 5.115a1 1 0 0 1 .04 1.346L7.924 18.5H18.25a1 1 0 1 1 0 2H5.75a1 1 0 0 1-.76-1.65l5.999-6.999L5.03 5.695a1 1 0 0 1-.2-1.085"},null,-1)]),4)}]]),ns={name:"Sessions",components:{SessionDetailsModal:Se,SessionTable:dt,TopHeader:se,EnergyHistoryChart:vt,EnergyGroupedChart:Dt,IconSelectGroup:X,IconSelectItem:Q,SelectGroup:q,CustomSelect:o,SolarGroupedChart:Mt,SolarYearChart:At,PeriodSelector:qt,DateNavigator:os,DynamicPriceIcon:J,CostHistoryChart:It,CostGroupedChart:Kt,AvgCostGroupedChart:Ut},mixins:[a],props:{notifications:Array,month:{type:Number,default:()=>(new Date).getMonth()+1},year:{type:Number,default:()=>(new Date).getFullYear()},period:{type:String,default:yt.MONTH},loadpointFilter:{type:String,default:""},vehicleFilter:{type:String,default:""},offline:Boolean},data:()=>({sessions:[],selectedType:x.sessionsType||gt.SOLAR,selectedGroup:x.sessionsGroup||mt.NONE,selectedSessionId:void 0,periods:yt,types:gt,groups:mt}),head(){return{title:`${this.$t("sessions.title")} | evcc`}},computed:{currency:()=>ee.state.currency||"EUR",energyTitle(){return this.$t("sessions.chartTitle.energy")},historyTitle(){return this.activeType===gt.SOLAR?this.energyTitle:this.costTitle},historySubTitle(){return this.activeType===gt.SOLAR?this.energySubTitle:this.costSubTitle},firstExtraTitle(){return this.activeType===gt.SOLAR?this.solarTitle:this.avgCostTitle},secondExtraTitle(){return this.activeType===gt.SOLAR?this.energyGroupedTitle:this.costGroupedTitle},solarPercentageFmt(){return this.fmtPercentage(this.totalEnergy>0?100/this.totalEnergy*this.selfEnergy:0)},energySumFmt(){return this.fmtWh(1e3*this.totalEnergy,w.AUTO)},energySubTitle(){return`${this.$t("sessions.chartTitle.energySubTotal",{value:this.energySumFmt})} ・ ${this.$t("sessions.chartTitle.energySubSolar",{value:this.solarPercentageFmt})}`},solarTitle(){return this.selectedGroup===mt.NONE?this.$t("sessions.chartTitle.solar"):this.$t("sessions.chartTitle.solarByGroup",{byGroup:this.byGroupTitle})},byGroupTitle(){return this.selectedGroup===mt.LOADPOINT?this.$t("sessions.chartTitle.byGroupLoadpoint"):this.selectedGroup===mt.VEHICLE?this.$t("sessions.chartTitle.byGroupVehicle"):""},energyGroupedTitle(){return this.selectedGroup===mt.NONE?this.$t("sessions.chartTitle.energyGrouped"):this.$t("sessions.chartTitle.energyGroupedByGroup",{byGroup:this.byGroupTitle})},avgCostTitle(){const e=this.activeType===gt.PRICE?"Price":"Co2";return this.$t(`sessions.chartTitle.avg${e}ByGroup`,{byGroup:this.byGroupTitle})},costGroupedTitle(){const e=this.activeType===gt.PRICE?"Price":"Co2";return this.$t(`sessions.chartTitle.grouped${e}ByGroup`,{byGroup:this.byGroupTitle})},periodOptions(){return Object.entries(yt).map((([e,t])=>({name:this.$t(`sessions.period.${e.toLowerCase()}`),value:t})))},typeOptions(){return Object.values(gt).map((e=>{const t=e===gt.PRICE&&!this.typePriceAvailable||e===gt.CO2&&!this.typeCo2Available,s=this.activeType===e;return{label:this.$t(`sessions.type.${e}`),value:e,disabled:t,active:s}}))},totalEnergy(){return this.currentSessions.reduce(((e,t)=>e+t.chargedEnergy),0)},selfEnergy(){return this.currentSessions.reduce(((e,t)=>e+t.chargedEnergy/100*t.solarPercentage),0)},currentSessionsWithPrice(){return this.currentSessions.filter((e=>null!==e.price))},currentTypeSessions(){return this.activeType===gt.PRICE?this.currentSessionsWithPrice:this.activeType===gt.CO2?this.currentSessionsWithCo2:this.currentSessions},totalPrice(){return this.currentSessionsWithPrice.reduce(((e,t)=>e+t.price),0)},pricePerKWh(){const e=this.currentSessionsWithPrice.reduce(((e,t)=>e+t.chargedEnergy),0);return e?this.totalPrice/e:null},currentSessionsWithCo2(){return this.currentSessions.filter((e=>null!==e.co2PerKWh))},totalCo2(){return this.currentSessionsWithCo2.reduce(((e,t)=>e+t.co2PerKWh*t.chargedEnergy),0)},co2PerKWh(){const e=this.currentSessionsWithCo2.reduce(((e,t)=>e+t.chargedEnergy),0);return e?this.totalCo2/e:null},costTitle(){const e=this.activeType===gt.PRICE?"Price":"Co2";return this.$t(`sessions.chartTitle.history${e}`)},avgCostFmt(){return this.activeType===gt.PRICE?this.fmtPricePerKWh(this.pricePerKWh,this.currency):this.fmtCo2Medium(this.co2PerKWh)},costSubTitle(){const e=this.activeType===gt.PRICE?"Price":"Co2",t=this.activeType===gt.PRICE?this.fmtMoney(this.totalPrice,this.currency,!0,!0):this.fmtGrams(this.totalCo2);return`${this.$t(`sessions.chartTitle.history${e}Sub`,{value:t})} ・ ⌀ ${this.avgCostFmt}`},activeType(){return this.selectedType===gt.PRICE&&this.typePriceAvailable?gt.PRICE:this.selectedType===gt.CO2&&this.typeCo2Available?gt.CO2:gt.SOLAR},showCostCharts(){return this.typePriceAvailable||this.typeCo2Available},typePriceAvailable(){return this.currentSessionsWithPrice.length>0},typeCo2Available(){return this.currentSessionsWithCo2.length>0},startDate(){return new Date(this.sessions[0]?.created||Date.now())},topNavigation:function(){return{vehicleLogins:ee.state.auth?ee.state.auth.vehicles:{},...this.collectProps(TopNavigation,ee.state)}},sessionsWithDefaults(){return this.sessions.map((e=>{const t=e.loadpoint||this.$t("main.loadpoint.fallbackName"),s=e.vehicle||this.$t("main.vehicle.unknown");return{...e,loadpoint:t,vehicle:s}}))},currentSessions(){return this.sessionsWithDefaults.filter((e=>{const t=new Date(e.created);switch(this.period){case yt.MONTH:return t.getFullYear()===this.year&&t.getMonth()+1===this.month;case yt.YEAR:return t.getFullYear()===this.year;case yt.TOTAL:return!0;default:return!1}}))},vehicleList(){const e=ee.state.vehicles||{};return Object.entries(e).map((([e,t])=>({name:e,...t})))},loadpointList:()=>(ee.state.loadpoints||[]).map((({title:e})=>e)),selectedSession(){return this.sessions.find((e=>e.id==this.selectedSessionId))},monthName(){const e=new Date;return e.setMonth(this.month-1,1),this.fmtMonth(e)},headline(){const e=new Date;return e.setMonth(this.month-1,1),e.setFullYear(this.year),this.fmtMonthYear(e)},csvLink(){return this.csvHrefLink(this.year,this.month)},csvTotalLink(){return this.csvHrefLink()},colorMappings(){const e=new Date;e.setMonth(e.getMonth()-3);const t=t=>this.sessionsWithDefaults.reduce(((s,a)=>{if(new Date(a.created)>=e){const e=a[t];s[e]=(s[e]||0)+a.chargedEnergy}return s}),{}),s=(e,t)=>{const s={};let a=0;return Object.entries(e).sort(((e,t)=>t[1]-e[1])).forEach((([e])=>{s[e]||(s[e]=E.palette[a%E.palette.length],a++)})),this.sessionsWithDefaults.forEach((e=>{const o=e[t];s[o]||(s[o]=E.palette[a%E.palette.length],a++)})),s};return{loadpoint:s(t("loadpoint"),"loadpoint"),vehicle:s(t("vehicle"),"vehicle"),solar:{self:E.self,grid:E.grid},cost:{price:E.price,co2:E.co2}}},groupIcons:()=>({[mt.NONE]:is,[mt.LOADPOINT]:"shopicon-regular-cablecharge",[mt.VEHICLE]:"shopicon-regular-car3"}),typeIcons:()=>({[gt.SOLAR]:"shopicon-regular-sun",[gt.PRICE]:J,[gt.CO2]:"shopicon-regular-eco1"}),costTypeIcons:()=>({[gt.PRICE]:J,[gt.CO2]:"shopicon-regular-eco1"}),showTable(){return this.period===yt.MONTH},showMonthNavigation(){return this.period===yt.MONTH},showYearNavigation(){return[yt.MONTH,yt.YEAR].includes(this.period)},showDateNavigator(){return this.showMonthNavigation||this.showYearNavigation},groupEntriesAvailable(){return!(this.selectedGroup===mt.NONE||!this.currentSessions.length)&&new Set(this.currentSessions.map((e=>e[this.selectedGroup]))).size>1},showSolarYearChart(){return this.period!==yt.MONTH&&this.selectedGroup===mt.NONE},showExtraCharts(){const e=new Set(this.currentTypeSessions.map((e=>e[this.selectedGroup]))).size>1,t=[mt.LOADPOINT,mt.VEHICLE].includes(this.selectedGroup),s=this.activeType===gt.SOLAR,a=this.period!==yt.MONTH;return t&&e||s&&a&&!t},suggestedMaxAvgPrice(){const e=this.sessions.filter((e=>null!==e.pricePerKWh)).map((e=>e.pricePerKWh));return this.percentile(e,98)},suggestedMaxAvgCo2(){const e=this.sessions.filter((e=>null!==e.co2PerKWh)).map((e=>e.co2PerKWh));return this.percentile(e,98)},suggestedMaxAvgCost(){return this.activeType===gt.PRICE?this.suggestedMaxAvgPrice:this.suggestedMaxAvgCo2},suggestedMaxCo2(){const e=this.sessions.filter((e=>null!==e.co2PerKWh)).reduce(((e,t)=>{const s=this.dateToPeriodKey(new Date(t.created));return e[s]=(e[s]||0)+t.co2PerKWh*t.chargedEnergy,e}),{});return Math.max(this.percentile(Object.values(e),98),5)},suggestedMaxPrice(){const e=this.sessions.filter((e=>null!==e.price)).reduce(((e,t)=>{const s=this.dateToPeriodKey(new Date(t.created));return e[s]=(e[s]||0)+t.price,e}),{});return Math.max(this.percentile(Object.values(e),98),1)},suggestedMaxCost(){return this.activeType===gt.PRICE?this.suggestedMaxPrice:this.suggestedMaxCo2}},watch:{offline:function(){this.loadSessions()}},mounted(){this.loadSessions()},methods:{changePeriod(e){let t=this.month,s=this.year,a=e;switch(a){case yt.TOTAL:t=void 0,s=void 0;break;case yt.YEAR:t=void 0;break;default:a=void 0}this.$router.push({query:{...this.$route.query,period:a,month:t,year:s}})},dateToPeriodKey(e){const t={year:"numeric",month:"numeric",day:"numeric"};return this.period===yt.YEAR&&(t.day=void 0),this.period===yt.TOTAL&&(t.month=void 0),e.toLocaleDateString(void 0,t)},async loadSessions(){const e=await i.get("sessions"),t=e.data?.result.sort(((e,t)=>new Date(e.created)-new Date(t.created)));this.sessions=t},showDetails(e){this.selectedSessionId=e,l.getOrCreateInstance(document.getElementById("sessionDetailsModal")).show()},csvHrefLink(e,t){const s=new URLSearchParams({format:"csv",lang:this.$i18n?.locale});return e&&t&&(s.append("year",e),s.append("month",t)),`./api/sessions?${s.toString()}`},updateType(e){this.selectedType=e,x.sessionsType=e},updateGroup(e){this.selectedGroup=e,x.sessionsGroup=e},updateDate({year:e,month:t}){this.$router.push({query:{...this.$route.query,year:e,month:t}})},percentile(e,t){if(0===e.length)return null;const s=e.sort(((e,t)=>e-t)),a=t/100*(s.length-1);return s[Math.floor(a)]}}},rs={class:"container px-4 safe-area-inset"},ls={class:"row"},cs={class:"col-12"},ds={class:"header-outer sticky-top"},hs={class:"container px-4"},us={class:"row py-3 py-sm-3 d-flex flex-column flex-sm-row gap-3 gap-lg-0 mb-lg-2"},ps={class:"col-lg-5 d-flex mb-lg-0"},gs={key:0,class:"col-lg-6 offset-lg-1"},ms={class:"d-flex gap-3 mb-5 justify-content-between flex-wrap pt-1"},ys={class:"fw-normal my-0 d-flex gap-3 flex-wrap d-flex align-items-baseline overflow-hidden"},fs={key:0,class:"d-block no-wrap text-truncate"},bs={class:"d-block no-wrap text-truncate"},vs={key:2,class:"row align-items-start"},Cs={class:"col-12 col-lg-6 mb-5"},xs={class:"fw-normal my-4"},ws={key:0},ks={class:"col-12 col-lg-6 mb-5"},Ds={class:"fw-normal my-4"},Ts={key:3},Ps={class:"d-grid gap-2 d-md-block mt-3 mb-5"},Es=["href"],Ss=["href"];e("default",s(ns,[["render",function(e,t,s,a,o,i){const n=v("TopHeader"),r=v("PeriodSelector"),l=v("DateNavigator"),y=v("IconSelectItem"),f=v("IconSelectGroup"),x=v("EnergyHistoryChart"),w=v("CostHistoryChart"),T=v("SolarYearChart"),P=v("SolarGroupedChart"),E=v("AvgCostGroupedChart"),S=v("EnergyGroupedChart"),M=v("CostGroupedChart"),O=v("SessionTable"),$=v("SessionDetailsModal");return C(),c("div",rs,[g(n,{title:e.$t("sessions.title")},null,8,["title"]),h("div",ls,[h("main",cs,[h("div",ds,[h("div",hs,[h("div",us,[h("div",ps,[g(r,{period:s.period,periodOptions:i.periodOptions,"onUpdate:period":i.changePeriod},null,8,["period","periodOptions","onUpdate:period"])]),i.showDateNavigator?(C(),c("div",gs,[g(l,{month:s.month,year:s.year,startDate:i.startDate,showMonth:i.showMonthNavigation,showYear:i.showYearNavigation,onUpdateDate:i.updateDate},null,8,["month","year","startDate","showMonth","showYear","onUpdateDate"])])):u("",!0)])])]),h("div",ms,[g(f,null,{default:m((()=>[(C(),c(b,null,k([!0,!1],(e=>(C(),c(b,null,[(C(!0),c(b,null,k(i.typeOptions,(({value:t,label:s,disabled:a,active:o})=>(C(),d(y,{key:t+e,label:e?s:void 0,class:D({"d-none d-lg-block":e,"d-block d-lg-none":!e}),disabled:a,active:o,onClick:e=>i.updateType(t)},{default:m((()=>[(C(),d(z(i.typeIcons[t])))])),_:2},1032,["label","class","disabled","active","onClick"])))),128))],64)))),64))])),_:1}),g(f,null,{default:m((()=>[(C(),c(b,null,k([!0,!1],(t=>(C(),c(b,null,[(C(!0),c(b,null,k(Object.values(o.groups),(s=>(C(),d(y,{key:s+t,active:o.selectedGroup===s,label:t?e.$t(`sessions.groupBy.${s.toLowerCase()}`):void 0,class:D({"d-none d-lg-block":t,"d-block d-lg-none":!t}),onClick:e=>i.updateGroup(s)},{default:m((()=>[(C(),d(z(i.groupIcons[s])))])),_:2},1032,["active","label","class","onClick"])))),128))],64)))),64))])),_:1})]),h("h3",ys,[i.historyTitle?(C(),c("span",fs,p(i.historyTitle),1)):u("",!0),h("small",bs,p(i.historySubTitle),1)]),i.activeType===o.types.SOLAR?(C(),d(x,{key:0,class:"mb-5",sessions:i.currentSessions,"color-mappings":i.colorMappings,"group-by":o.selectedGroup,period:s.period},null,8,["sessions","color-mappings","group-by","period"])):(C(),d(w,{key:1,class:"mb-5",sessions:i.currentTypeSessions,"color-mappings":i.colorMappings,"group-by":o.selectedGroup,"cost-type":i.activeType,currency:i.currency,period:s.period,"suggested-max-avg-cost":i.suggestedMaxAvgCost,"suggested-max-cost":i.suggestedMaxCost},null,8,["sessions","color-mappings","group-by","cost-type","currency","period","suggested-max-avg-cost","suggested-max-cost"])),i.showExtraCharts?(C(),c("div",vs,[h("div",Cs,[h("h3",xs,p(i.firstExtraTitle),1),i.activeType===o.types.SOLAR?(C(),c("div",ws,[i.showSolarYearChart?(C(),d(T,{key:0,period:s.period,sessions:i.currentSessions},null,8,["period","sessions"])):(C(),d(P,{key:1,sessions:i.currentSessions,"color-mappings":i.colorMappings,"group-by":o.selectedGroup},null,8,["sessions","color-mappings","group-by"]))])):(C(),d(E,{key:1,sessions:i.currentTypeSessions,"color-mappings":i.colorMappings,"suggested-max-price":i.suggestedMaxAvgCost,"group-by":o.selectedGroup,"cost-type":i.activeType,currency:i.currency},null,8,["sessions","color-mappings","suggested-max-price","group-by","cost-type","currency"]))]),h("div",ks,[h("h3",Ds,p(i.secondExtraTitle),1),i.activeType===o.types.SOLAR?(C(),d(S,{key:0,sessions:i.currentSessions,"color-mappings":i.colorMappings,"group-by":o.selectedGroup},null,8,["sessions","color-mappings","group-by"])):(C(),d(M,{key:1,sessions:i.currentTypeSessions,"color-mappings":i.colorMappings,"group-by":o.selectedGroup,"cost-type":i.activeType,currency:i.currency},null,8,["sessions","color-mappings","group-by","cost-type","currency"]))])])):u("",!0),i.showTable?(C(),c("div",Ts,[g(O,{sessions:i.currentSessions,vehicleFilter:s.vehicleFilter,loadpointFilter:s.loadpointFilter,currency:i.currency,onShowSession:i.showDetails},null,8,["sessions","vehicleFilter","loadpointFilter","currency","onShowSession"]),h("div",Ps,[i.currentSessions.length?(C(),c("a",{key:0,class:"btn btn-sm btn-outline-secondary text-nowrap me-md-2",href:i.csvLink,download:""},p(e.$t("sessions.csvMonth",{month:i.headline})),9,Es)):u("",!0),o.sessions.length?(C(),c("a",{key:1,class:"btn btn-sm btn-outline-secondary text-nowrap",href:i.csvTotalLink,download:""},p(e.$t("sessions.csvTotal")),9,Ss)):u("",!0)])])):(C(),c("button",{key:4,class:"btn btn-link text-muted mb-5",onClick:t[0]||(t[0]=e=>i.changePeriod(o.periods.MONTH))},p(e.$t("sessions.showIndividualEntries")),1))]),g($,{session:i.selectedSession,vehicles:i.vehicleList,loadpoints:i.loadpointList,currency:i.currency,onSessionChanged:i.loadSessions},null,8,["session","vehicles","loadpoints","currency","onSessionChanged"])])])}],["__scopeId","data-v-eeade8ae"]]))}}}));
